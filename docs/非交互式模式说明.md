# éäº¤äº’å¼æ¨¡å¼è¯´æ˜

## æ¦‚è¿°

æœ¬é¡¹ç›®ç°åœ¨å®Œå…¨æ”¯æŒ**éäº¤äº’å¼è¿è¡Œ**ï¼Œæ‰€æœ‰åŸæœ¬éœ€è¦ç”¨æˆ·è¾“å…¥çš„é€‰é¡¹éƒ½å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é¢„å…ˆè®¾ç½®ã€‚è¿™ä½¿å¾—çˆ¬è™«å¯ä»¥ï¼š

- âœ… åœ¨æœåŠ¡å™¨åå°è‡ªåŠ¨è¿è¡Œ
- âœ… é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆcron jobï¼‰
- âœ… é›†æˆåˆ°CI/CDæµç¨‹
- âœ… æ— éœ€äººå·¥å¹²é¢„åœ°æ‰¹é‡çˆ¬å–

## å·²é€‚é…çš„äº¤äº’å¼è¾“å…¥

### 1. çˆ¬å–æ¨¡å¼é€‰æ‹©
**åŸäº¤äº’æ–¹å¼ï¼š**
```
çˆ¬å–æ¨¡å¼:
  1. å•é¡µæ¨¡å¼ - ä»…çˆ¬å–ç¬¬ä¸€é¡µï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰
  2. å¤šé¡µæ¨¡å¼ - çˆ¬å–æ‰€æœ‰é¡µé¢ï¼ˆå®Œæ•´æ•°æ®ï¼‰
  3. é™åˆ¶é¡µæ•° - çˆ¬å–æŒ‡å®šé¡µæ•°
é€‰æ‹©æ¨¡å¼ (1/2/3, é»˜è®¤1): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
INTERACTIVE_MODE=false
SCRAPE_MODE=2              # 1=å•é¡µ, 2=å¤šé¡µ, 3=é™åˆ¶é¡µæ•°
MAX_PAGES_LIMIT=5          # å½“SCRAPE_MODE=3æ—¶ç”Ÿæ•ˆ
```

### 2. æ˜¯å¦çˆ¬å–è¯¦æƒ…é¡µ
**åŸäº¤äº’æ–¹å¼ï¼š**
```
æ˜¯å¦ç»§ç»­çˆ¬å–è¯¦æƒ…é¡µï¼Ÿ(y/n): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
SCRAPE_DETAILS=true        # true=çˆ¬å–è¯¦æƒ…, false=ä»…åˆ—è¡¨
```

### 3. çˆ¬å–äº§å“æ•°é‡
**åŸäº¤äº’æ–¹å¼ï¼š**
```
è¦çˆ¬å–å¤šå°‘ä¸ªäº§å“ï¼Ÿ(1-40, å›è½¦é»˜è®¤å…¨éƒ¨): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
MAX_PRODUCTS_TO_SCRAPE=    # ç•™ç©º=å…¨éƒ¨, è®¾ç½®æ•°å­—=æŒ‡å®šæ•°é‡
# æˆ–
MAX_PRODUCTS_TO_SCRAPE=50  # åªçˆ¬å–å‰50ä¸ª
```

### 4. è¯¦æƒ…é¡µçˆ¬å–æ¨¡å¼
**åŸäº¤äº’æ–¹å¼ï¼š**
```
çˆ¬å–æ¨¡å¼:
  1. é¡ºåºæ¨¡å¼ - ä¸€ä¸ªæ¥ä¸€ä¸ªçˆ¬å–ï¼ˆè¾ƒæ…¢ä½†ç¨³å®šï¼‰
  2. å¹¶è¡Œæ¨¡å¼ - å¤šçº¿ç¨‹åŒæ—¶çˆ¬å–ï¼ˆæ¨èï¼Œ3-5ä¸ªçº¿ç¨‹ï¼‰
é€‰æ‹©æ¨¡å¼ (1/2, é»˜è®¤2): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
DETAIL_SCRAPE_MODE=2       # 1=é¡ºåº, 2=å¹¶è¡Œ
```

### 5. å¹¶å‘çº¿ç¨‹æ•°
**åŸäº¤äº’æ–¹å¼ï¼š**
```
å¹¶å‘çº¿ç¨‹æ•° (å»ºè®®3-5, é»˜è®¤3): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
PARALLEL_MAX_WORKERS=5     # ç›´æ¥è®¾ç½®çº¿ç¨‹æ•°
```

### 6. æ–­ç‚¹ç»­ä¼ ç¡®è®¤ â­ æ–°å¢
**åŸäº¤äº’æ–¹å¼ï¼š**
```
ğŸ“‚ å‘ç°ä¹‹å‰çš„è¿›åº¦:
   å·²çˆ¬å–: 3 é¡µ
   äº§å“æ•°: 120 ä¸ª
æ˜¯å¦ç»§ç»­ä¹‹å‰çš„çˆ¬å–ï¼Ÿ(y/n): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
ENABLE_RESUME=true         # å¯ç”¨æ–­ç‚¹ç»­ä¼ åŠŸèƒ½
AUTO_RESUME=true           # è‡ªåŠ¨ç»§ç»­ï¼ˆéäº¤äº’å¼æ—¶ï¼‰
```

### 7. ç¿»è¯‘ç¡®è®¤ â­ æ–°å¢
**åŸäº¤äº’æ–¹å¼ï¼š**
```
æ˜¯å¦å¼€å§‹ç¿»è¯‘ï¼Ÿ(y/n): _
```

**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
RUN_TRANSLATION=true       # true=è¿è¡Œç¿»è¯‘, false=è·³è¿‡
```

### 8. å›¾ç‰‡å¤„ç†
**é…ç½®æ–‡ä»¶æ–¹å¼ï¼š**
```bash
RUN_IMAGE_PROCESSING=true  # true=å¤„ç†å›¾ç‰‡, false=è·³è¿‡
```

## å®Œæ•´é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹1: å¿«é€Ÿæµ‹è¯•ï¼ˆå•é¡µï¼Œæ— è¯¦æƒ…ï¼‰

```bash
# .env
INTERACTIVE_MODE=false
SCRAPE_MODE=1
SCRAPE_DETAILS=false
RUN_TRANSLATION=false
RUN_IMAGE_PROCESSING=false
CHROME_HEADLESS=true
```

**è¿è¡Œï¼š**
```bash
uv run python main.py
```

**é¢„æœŸè¡Œä¸ºï¼š**
- ä¸è¯¢é—®ä»»ä½•é—®é¢˜
- çˆ¬å–ç¬¬ä¸€é¡µçš„40ä¸ªäº§å“åŸºæœ¬ä¿¡æ¯
- è·³è¿‡è¯¦æƒ…é¡µ
- è·³è¿‡ç¿»è¯‘å’Œå›¾ç‰‡å¤„ç†
- 1-2åˆ†é’Ÿå®Œæˆ

### ç¤ºä¾‹2: å®Œæ•´çˆ¬å–ï¼ˆå¤šé¡µ+è¯¦æƒ…+åå¤„ç†ï¼‰

```bash
# .env
INTERACTIVE_MODE=false
SCRAPE_MODE=2                  # å¤šé¡µæ¨¡å¼
SCRAPE_DETAILS=true            # çˆ¬å–è¯¦æƒ…
MAX_PRODUCTS_TO_SCRAPE=        # å…¨éƒ¨äº§å“
DETAIL_SCRAPE_MODE=2           # å¹¶è¡Œæ¨¡å¼
PARALLEL_MAX_WORKERS=5         # 5ä¸ªçº¿ç¨‹
ENABLE_RESUME=true             # å¯ç”¨æ–­ç‚¹ç»­ä¼ 
AUTO_RESUME=true               # è‡ªåŠ¨ç»§ç»­
RUN_TRANSLATION=true           # è¿è¡Œç¿»è¯‘
RUN_IMAGE_PROCESSING=true      # å¤„ç†å›¾ç‰‡
CHROME_HEADLESS=true
```

**è¿è¡Œï¼š**
```bash
uv run python main.py
```

**é¢„æœŸè¡Œä¸ºï¼š**
- å®Œå…¨è‡ªåŠ¨è¿è¡Œ
- çˆ¬å–æ‰€æœ‰é¡µé¢
- çˆ¬å–æ‰€æœ‰äº§å“è¯¦æƒ…
- ä½¿ç”¨5ä¸ªçº¿ç¨‹å¹¶è¡Œ
- å¦‚æœ‰ä¹‹å‰çš„è¿›åº¦è‡ªåŠ¨ç»§ç»­
- è‡ªåŠ¨ç¿»è¯‘
- è‡ªåŠ¨å¤„ç†å›¾ç‰‡
- æ•°å°æ—¶å®Œæˆï¼ˆå–å†³äºäº§å“æ•°é‡ï¼‰

### ç¤ºä¾‹3: é™åˆ¶é¡µæ•°+éƒ¨åˆ†äº§å“

```bash
# .env
INTERACTIVE_MODE=false
SCRAPE_MODE=3                  # é™åˆ¶é¡µæ•°æ¨¡å¼
MAX_PAGES_LIMIT=5              # çˆ¬å–5é¡µ
SCRAPE_DETAILS=true
MAX_PRODUCTS_TO_SCRAPE=100     # åªçˆ¬å–å‰100ä¸ªäº§å“çš„è¯¦æƒ…
DETAIL_SCRAPE_MODE=2
PARALLEL_MAX_WORKERS=3
RUN_TRANSLATION=false          # è·³è¿‡ç¿»è¯‘
RUN_IMAGE_PROCESSING=true      # å¤„ç†å›¾ç‰‡
CHROME_HEADLESS=true
```

**é¢„æœŸè¡Œä¸ºï¼š**
- çˆ¬å–å‰5é¡µï¼ˆçº¦200ä¸ªäº§å“ï¼‰
- åªçˆ¬å–å‰100ä¸ªäº§å“çš„è¯¦æƒ…
- ä½¿ç”¨3ä¸ªçº¿ç¨‹
- è·³è¿‡ç¿»è¯‘
- å¤„ç†å›¾ç‰‡
- çº¦1-2å°æ—¶å®Œæˆ

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æœåŠ¡å™¨å®šæ—¶ä»»åŠ¡

```bash
# crontab -e
# æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨çˆ¬å–
0 2 * * * cd /path/to/hb_scraper && uv run python main.py >> logs/cron.log 2>&1
```

é…ç½®æ–‡ä»¶è®¾ç½®ä¸ºå®Œå…¨è‡ªåŠ¨æ¨¡å¼ã€‚

### åœºæ™¯2: Dockerå®¹å™¨è¿è¡Œ

```dockerfile
FROM python:3.11
WORKDIR /app
COPY . .
RUN pip install uv && uv sync
CMD ["uv", "run", "python", "main.py"]
```

é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥é…ç½®ï¼š
```bash
docker run -e INTERACTIVE_MODE=false -e SCRAPE_MODE=2 hb-scraper
```

### åœºæ™¯3: CI/CDé›†æˆ

```yaml
# .github/workflows/scrape.yml
name: Daily Scrape
on:
  schedule:
    - cron: '0 0 * * *'
jobs:
  scrape:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run scraper
        run: |
          uv run python main.py
        env:
          INTERACTIVE_MODE: false
          SCRAPE_MODE: 1
```

### åœºæ™¯4: å¤šé…ç½®æ‰¹é‡çˆ¬å–

```bash
# çˆ¬å–å¤šä¸ªä¸åŒåˆ†ç±»
categories=(
  "hair-skin-nails"
  "immune-support"
  "vitamin-d"
)

for cat in "${categories[@]}"; do
  export SCRAPER_CATEGORY_URL="https://www.hollandandbarrett.com/shop/vitamins-supplements/condition/${cat}/"
  export OUTPUT_COMPLETE_FILE="products_${cat}.csv"
  uv run python main.py
done
```

## è°ƒè¯•éäº¤äº’å¼æ¨¡å¼

### 1. æµ‹è¯•é…ç½®åŠ è½½

```bash
uv run python test_config.py
```

æŸ¥çœ‹æ‰€æœ‰é…ç½®æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚

### 2. éªŒè¯éäº¤äº’å¼è¿è¡Œ

åˆ›å»ºæµ‹è¯•é…ç½®ï¼š
```bash
cat > .env.test <<EOF
INTERACTIVE_MODE=false
SCRAPE_MODE=1
SCRAPE_DETAILS=false
RUN_TRANSLATION=false
RUN_IMAGE_PROCESSING=false
EOF

cp .env.test .env
uv run python main.py
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„çˆ¬å–æ¨¡å¼: 1
  â†’ å•é¡µæ¨¡å¼
é…ç½®æ–‡ä»¶è®¾ç½®: è·³è¿‡è¯¦æƒ…é¡µçˆ¬å–
è·³è¿‡ç¿»è¯‘ï¼ˆé…ç½®æ–‡ä»¶è®¾ç½®ï¼‰
è·³è¿‡å›¾ç‰‡å¤„ç†ï¼ˆé…ç½®æ–‡ä»¶è®¾ç½®ï¼‰
```

### 3. æ£€æŸ¥æ˜¯å¦ä»æœ‰äº¤äº’å¼è¾“å…¥

æœç´¢ä»£ç ä¸­çš„inputè°ƒç”¨ï¼š
```bash
grep -r "= input(" *.py utils/ scripts/ | grep -v "docs/"
```

## é…ç½®ä¼˜å…ˆçº§

1. **å‘½ä»¤è¡Œç¯å¢ƒå˜é‡**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
   ```bash
   INTERACTIVE_MODE=false uv run python main.py
   ```

2. **.env æ–‡ä»¶**
   ```bash
   INTERACTIVE_MODE=false
   ```

3. **ä»£ç é»˜è®¤å€¼**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
   ```python
   INTERACTIVE_MODE = os.getenv('INTERACTIVE_MODE', 'true')
   ```

## æ³¨æ„äº‹é¡¹

1. **INTERACTIVE_MODEæ˜¯ä¸»å¼€å…³**
   - è®¾ç½®ä¸º`false`åï¼Œæ‰€æœ‰äº¤äº’å¼è¾“å…¥éƒ½ä¼šä½¿ç”¨é…ç½®å€¼
   - è®¾ç½®ä¸º`true`ä¿æŒåŸæœ‰çš„äº¤äº’å¼è¡Œä¸º

2. **é…ç½®å®Œæ•´æ€§**
   - ä½¿ç”¨éäº¤äº’å¼æ¨¡å¼æ—¶ï¼Œç¡®ä¿æ‰€æœ‰ç›¸å…³é…ç½®éƒ½å·²è®¾ç½®
   - å»ºè®®ä½¿ç”¨`.env.example`ä½œä¸ºæ¨¡æ¿

3. **æ—¥å¿—è¾“å‡º**
   - éäº¤äº’å¼æ¨¡å¼ä¼šè¾“å‡ºé…ç½®ä½¿ç”¨çš„å†³ç­–
   - æ–¹ä¾¿è°ƒè¯•å’Œç›‘æ§

4. **é”™è¯¯å¤„ç†**
   - é…ç½®é”™è¯¯ä¼šä½¿ç”¨é»˜è®¤å€¼å¹¶ç»§ç»­è¿è¡Œ
   - å»ºè®®é€šè¿‡`test_config.py`éªŒè¯é…ç½®

## æ€»ç»“

é€šè¿‡å°†æ‰€æœ‰äº¤äº’å¼è¾“å…¥é€‚é…åˆ°é…ç½®æ–‡ä»¶ï¼Œæœ¬é¡¹ç›®ç°åœ¨æ”¯æŒï¼š

âœ… **8ä¸ªäº¤äº’å¼é€‰é¡¹**å…¨éƒ¨å¯é…ç½®
âœ… **å®Œå…¨è‡ªåŠ¨åŒ–è¿è¡Œ**
âœ… **çµæ´»çš„é…ç½®ç®¡ç†**
âœ… **å‘åå…¼å®¹**ï¼ˆé»˜è®¤ä»ä¸ºäº¤äº’å¼æ¨¡å¼ï¼‰
âœ… **é€‚åˆå„ç§è‡ªåŠ¨åŒ–åœºæ™¯**

æ— éœ€ä¿®æ”¹ä»£ç ï¼Œåªéœ€è°ƒæ•´`.env`é…ç½®æ–‡ä»¶å³å¯å®ç°ä¸åŒçš„çˆ¬å–ç­–ç•¥ï¼
